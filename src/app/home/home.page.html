<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title> Filmes Populares </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Filmes</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="gradient-overlay"></div>

  <ion-searchbar
    [(ngModel)]="searchTerm"
    (ionInput)="searchMovies()"
    placeholder="Buscar filmes..."
    class="custom-searchbar"
  ></ion-searchbar>

  <!-- Container principal com scroll horizontal -->
  <div class="movies-container">
    
    <!-- Linha 1 - 5 filmes -->
    @if (row1Movies.length > 0) {
      <div class="movies-row">
        <h3 class="row-title">Em Alta</h3>
        <div class="grid-5-cols">
          @for (movie of row1Movies; track movie.id) {
            <ion-card class="movie-card" button (click)="goToDetails(movie.id)">
              <div class="poster-container">
                <img 
                  [src]="'https://image.tmdb.org/t/p/w300' + movie.poster_path" 
                  [alt]="movie.title"
                  class="movie-poster"
                  (error)="movie.poster_path = '/assets/icon/favicon.png'"
                />
                <div class="rating-badge">
                  {{ movie.vote_average | number:'1.1-1' }}
                </div>
              </div>
              <ion-card-header>
                <ion-card-title class="movie-title">{{ movie.title }}</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <div class="stars-container">
                  {{ movie.vote_average | stars }}
                </div>
                <p class="movie-date">
                  {{ movie.release_date | date:'yyyy' }}
                </p>
              </ion-card-content>
            </ion-card>
          }
        </div>
      </div>
    }

    <!-- Linha 2 - 5 filmes -->
    @if (row2Movies.length > 0) {
      <div class="movies-row">
        <h3 class="row-title">Recomendados</h3>
        <div class="grid-5-cols">
          @for (movie of row2Movies; track movie.id) {
            <ion-card class="movie-card" button (click)="goToDetails(movie.id)">
              <div class="poster-container">
                <img 
                  [src]="'https://image.tmdb.org/t/p/w300' + movie.poster_path" 
                  [alt]="movie.title"
                  class="movie-poster"
                  (error)="movie.poster_path = '/assets/icon/favicon.png'"
                />
                <div class="rating-badge">
                  {{ movie.vote_average | number:'1.1-1' }}
                </div>
              </div>
              <ion-card-header>
                <ion-card-title class="movie-title">{{ movie.title }}</ion-card-title>
                 
              </ion-card-header>
              <ion-card-content>
                <div class="stars-container">
                  {{ movie.vote_average | stars }}
                </div>
                <p class="movie-date">
                  {{ movie.release_date | date:'yyyy' }}
                </p>
              </ion-card-content>
            </ion-card>
          }
        </div>
      </div>
    }

    <!-- Linha 5 - 6 filmes -->
    @if (row5Movies.length > 0) {
      <div class="movies-row">
        <h3 class="row-title">Em Breve</h3>
        <div class="grid-6-cols">
          @for (movie of row5Movies; track movie.id) {
            <ion-card class="movie-card" button (click)="goToDetails(movie.id)">
              <div class="poster-container">
                <img 
                  [src]="'https://image.tmdb.org/t/p/w300' + movie.poster_path" 
                  [alt]="movie.title"
                  class="movie-poster"
                  (error)="movie.poster_path = '/assets/icon/favicon.png'"
                />
                <div class="rating-badge">
                  {{ movie.vote_average | number:'1.1-1' }}
                </div>
              </div>
              <ion-card-header>
                <ion-card-title class="movie-title">{{ movie.title }}</ion-card-title>
                 
              </ion-card-header>
              <ion-card-content>
                <div class="stars-container">
                  {{ movie.vote_average | stars }}
                </div>
                <p class="movie-date">
                  {{ movie.release_date | date:'yyyy' }}
                </p>
              </ion-card-content>
            </ion-card>
          }
        </div>
      </div>
    }

    <!-- Linha 6 - 3 filmes -->
    @if (row6Movies.length > 0) {
      <div class="movies-row">
        <h3 class="row-title">Destaques</h3>
        <div class="grid-3-cols">
          @for (movie of row6Movies; track movie.id) {
            <ion-card class="movie-card featured" button (click)="goToDetails(movie.id)">
              <div class="poster-container">
                <img 
                  [src]="'https://image.tmdb.org/t/p/w400' + movie.poster_path" 
                  [alt]="movie.title"
                  class="movie-poster featured-poster"
                  (error)="movie.poster_path = '/assets/icon/favicon.png'"
                />
                <div class="rating-badge featured-badge">
                  {{ movie.vote_average | number:'1.1-1' }}
                </div>
              </div>
              <ion-card-header>
                <ion-card-title class="movie-title">{{ movie.title }}</ion-card-title>
                 
              </ion-card-header>
              <ion-card-content>
                <div class="stars-container">
                  {{ movie.vote_average | stars }}
                </div>
                <p class="movie-date">
                  {{ movie.release_date | date:'yyyy' }}
                </p>
              </ion-card-content>
            </ion-card>
          }
        </div>
      </div>
    }

    <!-- Mensagem quando não há filmes -->
    @if (allMovies.length === 0 && !searchTerm) {
      <div class="no-movies">
        <ion-spinner></ion-spinner>
        <p>Carregando filmes...</p>
      </div>
    }

    @if (allMovies.length === 0 && searchTerm) {
      <div class="no-movies">
        <p>Nenhum filme encontrado para "{{ searchTerm }}"</p>
      </div>
    }

  </div>
</ion-content>